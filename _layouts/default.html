<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page_title | escape }}</title>
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <link rel="icon" href="{{ '/favicon.svg' | relative_url }}" type="image/svg+xml">
  
  {% comment %} Generate absolute URLs for social sharing {% endcomment %}
  {% if jekyll.environment == 'production' %}
    {% assign base_site_url = site.url %}
  {% else %}
    {% assign base_site_url = 'http://localhost:4000' %}
  {% endif %}
  
  {% comment %} Set page-specific meta content {% endcomment %}
  {% if page.layout == 'experiment' %}
    {% assign page_title = page.title %}
    {% assign page_description = page.excerpt | strip_html | strip_newlines | truncate: 160 %}
    {% comment %} Fix URL path - remove /index/ suffix and ensure single trailing slash {% endcomment %}
    {% assign base_url = page.url | remove: '/index/' | remove: 'index.html' %}
    {% if base_url == '' %}{% assign base_url = '/' %}{% endif %}
    {% unless base_url contains '/experiments/' %}
      {% assign base_url = '/experiments' | append: base_url %}
    {% endunless %}
    {% comment %} Build image paths for experiment (avoid double slashes) {% endcomment %}
    {% assign experiment_jpg = base_url | append: 'image.jpg' %}
    {% assign experiment_png = base_url | append: 'image.png' %}
    {% comment %} For social sharing, try JPG first since most experiments use JPG {% endcomment %}
    {% assign page_image = base_site_url | append: experiment_jpg %}
    {% assign page_image_alt = base_site_url | append: experiment_png %}
    {% assign fallback_image = base_site_url | append: '/assets/img/social-image.png' %}
  {% elsif page.url == '/' %}
    {% assign page_title = "Bitpanda Labs - Exploring the Future of Finance" %}
    {% assign page_description = "Bitpanda's innovation playground for internal innovation, tech experiments, and product prototypes. Discover cutting-edge fintech solutions." %}
    {% assign page_image = base_site_url | append: '/assets/img/social-image.png' %}
  {% else %}
    {% assign page_title = page.title | default: site.title | append: ' | ' | append: site.title %}
    {% assign page_description = page.description | default: site.description | strip_html | truncate: 160 %}
    {% assign page_image = base_site_url | append: '/assets/img/social-image.png' %}
  {% endif %}
  
  <!-- Open Graph Meta Tags for Facebook, Instagram, LinkedIn, WhatsApp -->
  <meta property="og:title" content="{{ page_title | escape }}">
  <meta property="og:description" content="{{ page_description | escape }}">
  <meta property="og:image" content="{{ page_image }}">
  <meta property="og:image:secure_url" content="{{ page_image }}">
  {% if page.layout == 'experiment' and page_image_alt != page_image %}
    <!-- Provide alternative image format as backup -->
    <meta property="og:image" content="{{ page_image_alt }}">
    <meta property="og:image:secure_url" content="{{ page_image_alt }}">
  {% endif %}
  {% if page.layout == 'experiment' %}
    <!-- Always provide fallback image -->
    <meta property="og:image" content="{{ fallback_image }}">
    <meta property="og:image:secure_url" content="{{ fallback_image }}">
  {% endif %}
  {% if page.layout == 'experiment' %}
    <meta property="og:image:width" content="1600">
    <meta property="og:image:height" content="900">
  {% else %}
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="675">
  {% endif %}
  <meta property="og:image:alt" content="{{ page_title | escape }}">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:type" content="image/jpeg">
  <meta property="og:url" content="{{ base_site_url }}{{ page.url | replace: '/index/', '/' | replace: 'index.html', '' }}">
  <meta property="og:type" content="{% if page.layout == 'experiment' %}article{% else %}website{% endif %}">
  <meta property="og:site_name" content="{{ site.title | escape }}">
  <meta property="og:locale" content="en_US">
  
  <!-- Additional Open Graph properties for better platform support -->
  <meta property="og:updated_time" content="{% if page.date %}{{ page.date | date_to_xmlschema }}{% else %}{{ site.time | date_to_xmlschema }}{% endif %}">
  <meta property="og:determiner" content="the">
  
  <!-- Facebook-specific properties -->
  <meta property="fb:app_id" content="">
  
  <!-- LinkedIn-specific optimizations -->
  <meta property="og:see_also" content="{{ base_site_url }}">
  <meta property="linkedin:owner" content="bitpanda">
  
  <!-- Pinterest-specific (though it uses Open Graph) -->
  <meta property="og:rich_attachment" content="true">
  
  <!-- Instagram-specific (uses Facebook's Open Graph) -->
  <meta property="instagram:media_type" content="image">
  {% if page.date %}
    <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
    <meta property="article:author" content="Bitpanda Labs">
    {% if page.categories %}
      {% for category in page.categories %}
    <meta property="article:tag" content="{{ category }}">
      {% endfor %}
    {% endif %}
  {% endif %}
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@bitpanda">
  <meta name="twitter:creator" content="@bitpanda">
  <meta name="twitter:title" content="{{ page_title | escape }}">
  <meta name="twitter:description" content="{{ page_description | escape }}">
  <!-- Primary Twitter image -->
  <meta name="twitter:image" content="{{ page_image }}">
  <meta name="twitter:image:src" content="{{ page_image }}">
  {% if page.layout == 'experiment' and page_image_alt != page_image %}
    <!-- Alternative Twitter image format -->
    <meta name="twitter:image0" content="{{ page_image }}">
    <meta name="twitter:image1" content="{{ page_image_alt }}">
    <meta name="twitter:image2" content="{{ fallback_image }}">
  {% endif %}
  <meta name="twitter:image:alt" content="{{ page_title | escape }}">
  {% if page.layout == 'experiment' %}
    <meta name="twitter:image:width" content="1600">
    <meta name="twitter:image:height" content="900">
  {% else %}
    <meta name="twitter:image:width" content="1200">
    <meta name="twitter:image:height" content="675">
  {% endif %}
  <meta name="twitter:domain" content="{{ base_site_url | remove: 'http://' | remove: 'https://' }}">
  <meta name="twitter:url" content="{{ base_site_url }}{{ page.url | replace: '/index/', '/' | replace: 'index.html', '' }}">
  
  <!-- Additional Twitter properties -->
  <meta name="twitter:label1" content="Reading time">
  <meta name="twitter:data1" content="{% if page.layout == 'experiment' %}5 min read{% else %}2 min read{% endif %}">
  <meta name="twitter:label2" content="Category">
  <meta name="twitter:data2" content="{% if page.layout == 'experiment' %}Fintech Innovation{% else %}Innovation Lab{% endif %}">
  
  <!-- Additional SEO Meta Tags -->
  <meta name="description" content="{{ page_description | escape }}">
  <meta name="author" content="Bitpanda Labs">
  <meta name="publisher" content="Bitpanda Labs">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <link rel="canonical" href="{{ base_site_url }}{{ page.url | replace: '/index/', '/' | replace: 'index.html', '' }}">
  
  <!-- WhatsApp and Telegram optimization -->
  <meta property="telegram:channel" content="@bitpanda">
  
  <!-- Schema.org structured data for better platform recognition -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "{% if page.layout == 'experiment' %}Article{% else %}WebSite{% endif %}",
    "name": "{{ page_title | escape | jsonify }}",
    "headline": "{{ page_title | escape | jsonify }}",
    "description": "{{ page_description | escape | jsonify }}",
    "url": "{{ base_site_url }}{{ page.url }}",
    "image": {
      "@type": "ImageObject",
      "url": "{% if page.layout == 'experiment' %}{{ base_site_url }}{{ experiment_png }}{% else %}{{ page_image }}{% endif %}",
      "width": 1200,
      "height": 675
    },
    "publisher": {
      "@type": "Organization",
      "name": "Bitpanda Labs",
      "url": "{{ base_site_url }}",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ base_site_url }}/assets/Bitpanda_Lettermark_white_RGB.png"
      }
    }{% if page.layout == 'experiment' and page.date %},
    "datePublished": "{{ page.date | date_to_xmlschema }}",
    "dateModified": "{{ page.date | date_to_xmlschema }}",
    "author": {
      "@type": "Organization",
      "name": "Bitpanda Labs"
    }{% endif %}
  }
  </script>
  
</head>
<body{% if page.layout == 'experiment' %} class="experiment-layout"{% endif %}>
  <header>
    <nav class="nav-container">
      <div class="nav-brand">
        <a href="/" class="brand-link">
          <img src="{{ '/assets/Bitpanda_Lettermark_white_RGB.png' | relative_url }}" alt="Bitpanda Labs" class="logo">
          <span class="site-title">Labs</span>
        </a>
      </div>
      <div class="nav-links">
        <a href="/" class="nav-link" data-section="">Home</a>
        {% if page.url == '/' %}
          <a href="#experiments" class="nav-link" data-section="experiments">Experiments</a>
        {% else %}
          <a href="/experiments" class="nav-link" data-section="experiments">Experiments</a>
        {% endif %}
        {% if page.url == '/' %}
          <a href="#about" class="nav-link" data-section="about">About</a>
        {% else %}
          <a href="/experiments/2025_09_23_bitpanda_labs/index/" class="nav-link" data-section="about">About</a>
        {% endif %}
      </div>
    </nav>
  </header>
  <main>
    {{ content }}
  </main>
  <footer>
    <ul>
      <li><a href="https://www.bitpanda.com/?utm_source=bitpanda_labs&utm_medium=website&utm_campaign=labs_footer" target="_blank">Go to Bitpanda.com</a></li>
      <li><a href="https://www.bitpanda.com/en/about-us" target="_blank">About Bitpanda</a></li>
      <li><a href="https://www.bitpanda.com/en/career" target="_blank">Careers at Bitpanda</a></li>
      <li><a href="https://www.bitpanda.com/en/press-downloads" target="_blank">Press</a></li>
      <li><a href="https://blog.bitpanda.com/en" target="_blank">Blog</a></li>
      <li><a href="https://support.bitpanda.com/hc/en-us" target="_blank">Help</a></li>
    </ul>
  </footer>
  <script>
    // Handle image loading errors silently
    function handleImageError(img, fallbackPath, defaultPath) {
      // Remove error handler to avoid infinite loops
      img.onerror = null;
      
      // If current src contains .jpg, try PNG
      if (img.src.includes('.jpg')) {
        img.onerror = function() {
          img.onerror = null;
          img.src = defaultPath;
        };
        img.src = fallbackPath;
      } else {
        // Already tried PNG or other format, use default
        img.src = defaultPath;
      }
    }

    // Handle active state and smooth scrolling for navigation links
    function updateActiveLink() {
      const hash = window.location.hash.slice(1) || '';
      const pathname = window.location.pathname;
      const links = document.querySelectorAll('.nav-link');
      
      links.forEach(link => {
        const section = link.getAttribute('data-section');
        const href = link.getAttribute('href');
        
        // Check if we're on a specific page
        if (pathname === '/experiments/2025_09_23_bitpanda_labs/index/' && href === '/experiments/2025_09_23_bitpanda_labs/index/') {
          link.classList.add('active');
        } else if (pathname.startsWith('/experiments') && href === '/experiments' && pathname !== '/experiments/2025_09_23_bitpanda_labs/index/') {
          link.classList.add('active');
        } else if (pathname === '/' && href === '/' && hash === '') {
          link.classList.add('active');
        } else if (pathname === '/' && hash === section && section !== '') {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
    }

    // Handle smooth scrolling (supports href="#id" and href="/#id")
    document.querySelectorAll('a[href^="#"], a[href^="/#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const rawHref = this.getAttribute('href');
        const targetId = rawHref.replace(/^\/#/, '').replace(/^#/, '');
        if (!targetId) return;
        
        const targetElement = document.getElementById(targetId);
        if (!targetElement) return;

        const headerOffset = 100; // Adjust this value based on your header height
        const elementPosition = targetElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        });

        // Update URL without scrolling
        history.pushState(null, null, '#' + targetId);
        updateActiveLink();
      });
    });

    // Smooth-scroll to top when clicking Home while already on the homepage
    (function() {
      const rootPath = '{{ "/" | relative_url }}';
      const homeLinks = document.querySelectorAll(`a.nav-link[href="${rootPath}"]`);
      homeLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          if (window.location.pathname === rootPath) {
            e.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
            history.pushState(null, null, rootPath);
            updateActiveLink();
          }
        });
      });
    })();

    // Update active link on page load and hash change
    window.addEventListener('load', updateActiveLink);
    window.addEventListener('hashchange', updateActiveLink);
  </script>
</body>
</html> 