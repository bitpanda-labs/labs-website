<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page_title | escape }}</title>
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <link rel="icon" href="{{ '/favicon.svg' | relative_url }}" type="image/svg+xml">
  
  {% comment %} Generate absolute URLs for social sharing {% endcomment %}
  {% if jekyll.environment == 'production' %}
    {% assign base_site_url = site.url %}
  {% else %}
    {% assign base_site_url = 'http://localhost:4000' %}
  {% endif %}
  
  {% comment %} Set page-specific meta content {% endcomment %}
  {% if page.layout == 'experiment' %}
    {% assign page_title = page.title %}
    {% assign page_description = page.excerpt | strip_html | strip_newlines | truncate: 160 %}
    {% assign base_url = page.url
      | remove: 'index.html'
      | remove: '/index/'
      | remove: 'index/' %}
    {% if base_url == '' %}{% assign base_url = '/' %}{% endif %}
    {% unless base_url contains '/experiments/' %}
      {% assign base_url = '/experiments' | append: base_url %}
    {% endunless %}
    {% assign last_char = base_url | slice: -1, 1 %}
    {% if last_char != '/' %}
      {% assign base_url = base_url | append: '/' %}
    {% endif %}
    {% assign base_url = base_url | replace: '//', '/' %}
    {% comment %} Build image paths for experiment (avoid double slashes) {% endcomment %}
    {% assign experiment_jpg = base_url | append: 'image.jpg' %}
    {% assign experiment_png = base_url | append: 'image.png' %}
    {% comment %} For social sharing, try JPG first since most experiments use JPG {% endcomment %}
    {% assign page_image = base_site_url | append: experiment_jpg %}
    {% assign page_image_alt = base_site_url | append: experiment_png %}
    {% assign fallback_image = base_site_url | append: '/assets/img/social-image.png' %}
  {% elsif page.url == '/' %}
    {% assign page_title = "Bitpanda Labs - Exploring the Future of Finance" %}
    {% assign page_description = "Bitpanda's innovation playground for internal innovation, tech experiments, and product prototypes. Discover cutting-edge fintech solutions." %}
    {% assign page_image = base_site_url | append: '/assets/img/social-image.png' %}
  {% else %}
    {% assign page_title = page.title | default: site.title | append: ' | ' | append: site.title %}
    {% assign page_description = page.description | default: site.description | strip_html | truncate: 160 %}
    {% assign page_image = base_site_url | append: '/assets/img/social-image.png' %}
  {% endif %}
  
  <!-- Open Graph Meta Tags for Facebook, Instagram, LinkedIn, WhatsApp -->
  <meta property="og:title" content="{{ page_title | escape }}">
  <meta property="og:description" content="{{ page_description | escape }}">
  <meta property="og:image" content="{{ page_image }}">
  <meta property="og:image:secure_url" content="{{ page_image }}">
  {% if page.layout == 'experiment' and page_image_alt != page_image %}
    <meta property="og:image" content="{{ page_image_alt }}">
    <meta property="og:image:secure_url" content="{{ page_image_alt }}">
  {% endif %}
  {% if page.layout == 'experiment' %}
    <meta property="og:image" content="{{ fallback_image }}">
    <meta property="og:image:secure_url" content="{{ fallback_image }}">
  {% endif %}
  {% if page.layout == 'experiment' %}
    <meta property="og:image:width" content="1600">
    <meta property="og:image:height" content="900">
  {% else %}
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="675">
  {% endif %}
  <meta property="og:image:alt" content="{{ page_title | escape }}">
  <meta property="og:url" content="{{ base_site_url }}{{ page.url | replace: '/index/', '/' | replace: 'index.html', '' }}">
  <meta property="og:type" content="{% if page.layout == 'experiment' %}article{% else %}website{% endif %}">
  <meta property="og:site_name" content="{{ site.title | escape }}">
  <meta property="og:locale" content="en_US">
  
  <!-- Additional Open Graph properties for better platform support -->
  <meta property="og:updated_time" content="{% if page.date %}{{ page.date | date_to_xmlschema }}{% else %}{{ site.time | date_to_xmlschema }}{% endif %}">
  <meta property="og:determiner" content="the">
  
  <!-- Facebook-specific properties -->
  <meta property="fb:app_id" content="">
  
  <!-- LinkedIn-specific optimizations -->
  <meta property="og:see_also" content="{{ base_site_url }}">
  <meta property="linkedin:owner" content="bitpanda">
  
  <!-- Pinterest-specific (though it uses Open Graph) -->
  <meta property="og:rich_attachment" content="true">
  
  <!-- Instagram-specific (uses Facebook's Open Graph) -->
  <meta property="instagram:media_type" content="image">
  {% if page.date %}
    <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
    <meta property="article:author" content="Bitpanda Labs">
    {% if page.categories %}
      {% for category in page.categories %}
    <meta property="article:tag" content="{{ category }}">
      {% endfor %}
    {% endif %}
  {% endif %}
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@bitpanda">
  <meta name="twitter:creator" content="@bitpanda">
  <meta name="twitter:title" content="{{ page_title | escape }}">
  <meta name="twitter:description" content="{{ page_description | escape }}">
  <!-- Primary Twitter image -->
  <meta name="twitter:image" content="{{ page_image }}">
  <meta name="twitter:image:src" content="{{ page_image }}">
  {% if page.layout == 'experiment' and page_image_alt != page_image %}
    <!-- Alternative Twitter image format -->
    <meta name="twitter:image0" content="{{ page_image }}">
    <meta name="twitter:image1" content="{{ page_image_alt }}">
    <meta name="twitter:image2" content="{{ fallback_image }}">
  {% endif %}
  <meta name="twitter:image:alt" content="{{ page_title | escape }}">
  {% if page.layout == 'experiment' %}
    <meta name="twitter:image:width" content="1600">
    <meta name="twitter:image:height" content="900">
  {% else %}
    <meta name="twitter:image:width" content="1200">
    <meta name="twitter:image:height" content="675">
  {% endif %}
  <meta name="twitter:domain" content="{{ base_site_url | remove: 'http://' | remove: 'https://' }}">
  <meta name="twitter:url" content="{{ base_site_url }}{{ page.url | replace: '/index/', '/' | replace: 'index.html', '' }}">
  
  <!-- Additional Twitter properties -->
  <meta name="twitter:label1" content="Reading time">
  <meta name="twitter:data1" content="{% if page.layout == 'experiment' %}5 min read{% else %}2 min read{% endif %}">
  <meta name="twitter:label2" content="Category">
  <meta name="twitter:data2" content="{% if page.layout == 'experiment' %}Fintech Innovation{% else %}Innovation Lab{% endif %}">
  
  <!-- Additional SEO Meta Tags -->
  <meta name="description" content="{{ page_description | escape }}">
  <meta name="author" content="Bitpanda Labs">
  <meta name="publisher" content="Bitpanda Labs">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <link rel="canonical" href="{{ base_site_url }}{{ page.url | replace: '/index/', '/' | replace: 'index.html', '' }}">
  
  <!-- WhatsApp and Telegram optimization -->
  <meta property="telegram:channel" content="@bitpanda">
  
  <!-- Schema.org structured data for better platform recognition -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "{% if page.layout == 'experiment' %}Article{% else %}WebSite{% endif %}",
    "name": {{ page_title | jsonify }},
    "headline": {{ page_title | jsonify }},
    "description": {{ page_description | jsonify }},
    "url": "{{ base_site_url }}{{ page.url | replace: '/index/', '/' | replace: 'index.html', '' }}",
    "image": {
      "@type": "ImageObject",
      "url": "{% if page.layout == 'experiment' %}{{ base_site_url }}{{ experiment_png }}{% else %}{{ page_image }}{% endif %}",
      "width": 1200,
      "height": 675
    },
    "publisher": {
      "@type": "Organization",
      "name": "Bitpanda Labs",
      "url": "{{ base_site_url }}",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ base_site_url }}/assets/Bitpanda_Lettermark_white_RGB.png"
      }
    }{% if page.layout == 'experiment' and page.date %},
    "datePublished": "{{ page.date | date_to_xmlschema }}",
    "dateModified": "{{ page.date | date_to_xmlschema }}",
    "author": {
      "@type": "Organization",
      "name": "Bitpanda Labs"
    }{% endif %}
  }
  </script>
  
</head>
<body{% if page.layout == 'experiment' %} class="experiment-layout"{% endif %}>
  <header>
    <nav class="nav-container">
      <div class="nav-brand">
        <a href="/" class="brand-link">
          <img src="{{ '/assets/Bitpanda_Lettermark_white_RGB.png' | relative_url }}" alt="Bitpanda Labs" class="logo">
          <span class="site-title">Labs</span>
        </a>
      </div>
      <div class="nav-links">
        <a href="/" class="nav-link" data-section="">Home</a>
        {% if page.url == '/' %}
          <a href="#experiments" class="nav-link" data-section="experiments">Experiments</a>
        {% else %}
          <a href="/experiments" class="nav-link" data-section="experiments">Experiments</a>
        {% endif %}
        {% if page.url == '/' %}
          <a href="#about" class="nav-link" data-section="about">About</a>
        {% else %}
          <a href="/experiments/2025_09_23_bitpanda_labs/index/" class="nav-link" data-section="about">About</a>
        {% endif %}
      </div>
    </nav>
  </header>
  <main>
    {{ content }}
  </main>
  <footer>
    <ul>
      <li><a href="https://www.bitpanda.com/?utm_source=bitpanda_labs&utm_medium=website&utm_campaign=labs_footer" target="_blank">Go to Bitpanda.com</a></li>
      <li><a href="https://www.bitpanda.com/en/about-us" target="_blank">About Bitpanda</a></li>
      <li><a href="https://www.bitpanda.com/en/career" target="_blank">Careers at Bitpanda</a></li>
      <li><a href="https://www.bitpanda.com/en/press-downloads" target="_blank">Press</a></li>
      <li><a href="https://blog.bitpanda.com/en" target="_blank">Blog</a></li>
      <li><a href="https://support.bitpanda.com/hc/en-us" target="_blank">Help</a></li>
      <li><a href="https://www.bitpanda.com/en/legal/bitpanda-group-privacy-notice" target="_blank">Privacy Policy</a></li>
    </ul>
  </footer>

  <!-- Cookie Consent Banner -->
  <div id="cookie-banner" class="cookie-banner">
    <div class="cookie-banner-container">
      <div class="cookie-banner-content">
        <div class="cookie-banner-title">Personalise your experience</div>
        <p class="cookie-banner-text">
          Cookies help us to optimize our services and your experience. We use the information as part of our EU-wide activities.
          <a href="https://www.bitpanda.com/en/legal/bitpanda-group-privacy-notice" target="_blank">Cookie policy</a>
        </p>
      </div>
      <div class="cookie-banner-actions">
        <button id="cookie-decline" class="cookie-btn cookie-btn-decline">Decline</button>
        <button id="cookie-accept" class="cookie-btn cookie-btn-accept">Accept</button>
      </div>
    </div>
  </div>

  <!-- Cookie Consent & Analytics Management -->
  <script>
    (function() {
      'use strict';

      const CONSENT_KEY = 'bitpanda_labs_cookie_consent';
      const CONSENT_TIMESTAMP_KEY = 'bitpanda_labs_cookie_consent_timestamp';
      const CONSENT_EXPIRY_DAYS = 365;

      // Check if consent has expired (older than CONSENT_EXPIRY_DAYS)
      function isConsentExpired() {
        const timestamp = localStorage.getItem(CONSENT_TIMESTAMP_KEY);
        if (!timestamp) return true;

        const consentDate = new Date(parseInt(timestamp));
        const expiryDate = new Date(consentDate.getTime() + CONSENT_EXPIRY_DAYS * 24 * 60 * 60 * 1000);
        return new Date() > expiryDate;
      }

      // Get consent status from localStorage
      function getConsent() {
        if (isConsentExpired()) {
          // Clear expired consent
          localStorage.removeItem(CONSENT_KEY);
          localStorage.removeItem(CONSENT_TIMESTAMP_KEY);
          return null;
        }
        return localStorage.getItem(CONSENT_KEY);
      }

      // Save consent status to localStorage
      function saveConsent(status) {
        localStorage.setItem(CONSENT_KEY, status);
        localStorage.setItem(CONSENT_TIMESTAMP_KEY, Date.now().toString());
      }

      // Load RudderStack analytics
      !function(){"use strict";window.RudderSnippetVersion="3.2.0";var e="rudderanalytics";window[e]||(window[e]=[])
      ;var rudderanalytics=window[e];if(Array.isArray(rudderanalytics)){
      if(true===rudderanalytics.snippetExecuted&&window.console&&console.error){
      console.error("RudderStack JavaScript SDK snippet included more than once.")}else{rudderanalytics.snippetExecuted=true,
      window.rudderAnalyticsBuildType="legacy";var sdkBaseUrl="https://cdn.rudderlabs.com";var sdkVersion="v3"
      ;var sdkFileName="rsa.min.js";var scriptLoadingMode="async"
      ;var r=["setDefaultInstanceKey","load","ready","page","track","identify","alias","group","reset","setAnonymousId","startSession","endSession","consent","addCustomIntegration"]
      ;for(var n=0;n<r.length;n++){var t=r[n];rudderanalytics[t]=function(r){return function(){var n
      ;Array.isArray(window[e])?rudderanalytics.push([r].concat(Array.prototype.slice.call(arguments))):null===(n=window[e][r])||void 0===n||n.apply(window[e],arguments)
      }}(t)}try{
      new Function('class Test{field=()=>{};test({prop=[]}={}){return prop?(prop?.property??[...prop]):import("");}}'),
      window.rudderAnalyticsBuildType="modern"}catch(i){}var d=document.head||document.getElementsByTagName("head")[0]
      ;var o=document.body||document.getElementsByTagName("body")[0];window.rudderAnalyticsAddScript=function(e,r,n){
      var t=document.createElement("script");t.src=e,t.setAttribute("data-loader","RS_JS_SDK"),r&&n&&t.setAttribute(r,n),
      "async"===scriptLoadingMode?t.async=true:"defer"===scriptLoadingMode&&(t.defer=true),
      d?d.insertBefore(t,d.firstChild):o.insertBefore(t,o.firstChild)},window.rudderAnalyticsMount=function(){!function(){
      if("undefined"==typeof globalThis){var e;var r=function getGlobal(){
      return"undefined"!=typeof self?self:"undefined"!=typeof window?window:null}();r&&Object.defineProperty(r,"globalThis",{
      value:r,configurable:true})}
      }(),window.rudderAnalyticsAddScript("".concat(sdkBaseUrl,"/").concat(sdkVersion,"/").concat(window.rudderAnalyticsBuildType,"/").concat(sdkFileName),"data-rsa-write-key","38CkLWnKmZjzNGHOIsGgd4NPjK8")
      },
      "undefined"==typeof Promise||"undefined"==typeof globalThis?window.rudderAnalyticsAddScript("https://polyfill-fastly.io/v3/polyfill.min.js?version=3.111.0&features=Symbol%2CPromise&callback=rudderAnalyticsMount"):window.rudderAnalyticsMount()
      ;var loadOptions={};rudderanalytics.load("38CkLWnKmZjzNGHOIsGgd4NPjK8","https://rudderstaczkxy.dataplane.rudderstack.com",loadOptions)}}}();

      // Show cookie banner
      function showBanner() {
        const banner = document.getElementById('cookie-banner');
        if (banner) {
          banner.classList.add('show');
        }
      }

      // Hide cookie banner
      function hideBanner() {
        const banner = document.getElementById('cookie-banner');
        if (banner) {
          banner.classList.remove('show');
        }
      }

      // Handle accept
      function handleAccept() {
        saveConsent('accepted');
        hideBanner();
        loadRudderStack();
      }

      // Handle decline
      function handleDecline() {
        saveConsent('declined');
        hideBanner();
      }

      // Initialize on page load
      function init() {
        const consent = getConsent();

        if (consent === 'accepted') {
          // User has accepted, load analytics
          loadRudderStack();
        } else if (consent === 'declined') {
          // User has declined, do nothing
        } else {
          // No consent yet, show banner
          showBanner();
        }

        // Set up event listeners
        const acceptBtn = document.getElementById('cookie-accept');
        const declineBtn = document.getElementById('cookie-decline');

        if (acceptBtn) {
          acceptBtn.addEventListener('click', handleAccept);
        }

        if (declineBtn) {
          declineBtn.addEventListener('click', handleDecline);
        }
      }

      // Run initialization when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>

  <script>
    // Handle image loading errors silently
    function handleImageError(img, fallbackPath, defaultPath) {
      // Remove error handler to avoid infinite loops
      img.onerror = null;
      
      // If current src contains .jpg, try PNG
      if (img.src.includes('.jpg')) {
        img.onerror = function() {
          img.onerror = null;
          img.src = defaultPath;
        };
        img.src = fallbackPath;
      } else {
        // Already tried PNG or other format, use default
        img.src = defaultPath;
      }
    }

    // Handle active state and smooth scrolling for navigation links
    function updateActiveLink() {
      const hash = window.location.hash.slice(1) || '';
      const pathname = window.location.pathname;
      const links = document.querySelectorAll('.nav-link');
      
      links.forEach(link => {
        const section = link.getAttribute('data-section');
        const href = link.getAttribute('href');
        
        // Check if we're on a specific page
        if (pathname === '/experiments/2025_09_23_bitpanda_labs/index/' && href === '/experiments/2025_09_23_bitpanda_labs/index/') {
          link.classList.add('active');
        } else if (pathname.startsWith('/experiments') && href === '/experiments' && pathname !== '/experiments/2025_09_23_bitpanda_labs/index/') {
          link.classList.add('active');
        } else if (pathname === '/' && href === '/' && hash === '') {
          link.classList.add('active');
        } else if (pathname === '/' && hash === section && section !== '') {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
    }

    // Handle smooth scrolling (supports href="#id" and href="/#id")
    document.querySelectorAll('a[href^="#"], a[href^="/#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const rawHref = this.getAttribute('href');
        const targetId = rawHref.replace(/^\/#/, '').replace(/^#/, '');
        if (!targetId) return;
        
        const targetElement = document.getElementById(targetId);
        if (!targetElement) return;

        const headerOffset = 100; // Adjust this value based on your header height
        const elementPosition = targetElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        });

        // Update URL without scrolling
        history.pushState(null, null, '#' + targetId);
        updateActiveLink();
      });
    });

    // Smooth-scroll to top when clicking Home while already on the homepage
    (function() {
      const rootPath = '{{ "/" | relative_url }}';
      const homeLinks = document.querySelectorAll(`a.nav-link[href="${rootPath}"]`);
      homeLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          if (window.location.pathname === rootPath) {
            e.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
            history.pushState(null, null, rootPath);
            updateActiveLink();
          }
        });
      });
    })();

    // Update active link on page load and hash change
    window.addEventListener('load', updateActiveLink);
    window.addEventListener('hashchange', updateActiveLink);
  </script>
</body>
</html> 